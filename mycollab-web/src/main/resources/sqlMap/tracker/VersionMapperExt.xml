<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.esofthead.mycollab.module.tracker.dao.VersionMapperExt">
	<select id="getFixedVersionByRelatedRefKey" parameterType="String"
		resultMap="com.esofthead.mycollab.module.tracker.dao.VersionMapper.BaseResultMap">
		SELECT m_tracker_version.id, m_tracker_version.projectid,
		m_tracker_version.description, m_tracker_version.duedate,
		m_tracker_version.versionname
		FROM m_tracker_version, m_tracker_related_item
		WHERE m_tracker_related_item.refitemkey = #{refkey}
		AND m_tracker_related_item.relateitemid = m_tracker_version.id
		AND m_tracker_related_item.type=0
    </select>

	<select id="getAffectedVersionsByRelatedRefKey" parameterType="String"
		resultMap="com.esofthead.mycollab.module.tracker.dao.VersionMapper.BaseResultMap">
		SELECT m_tracker_version.id, m_tracker_version.projectid,
		m_tracker_version.description, m_tracker_version.duedate,
		m_tracker_version.versionname
		FROM m_tracker_version, m_tracker_related_item
		WHERE m_tracker_related_item.refitemkey = #{refkey}
		AND m_tracker_related_item.relateitemid = m_tracker_version.id
		AND m_tracker_related_item.type=1
    </select>

	<sql id="selectVersion">
    <![CDATA[
        SELECT m_tracker_version.id, m_tracker_version.projectid,
               m_tracker_version.description, m_tracker_version.duedate,
               m_tracker_version.versionname
        FROM m_tracker_version, m_tracker_related_item
        WHERE m_tracker_related_item.refitemkey = #{refkey}
              AND m_tracker_related_item.relateitemid = m_tracker_version.id
    ]]>
	</sql>
</mapper>